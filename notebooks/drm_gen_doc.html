

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Generating DRMs for GBM detectors &mdash; gbm_drm_gen  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^0.21.0-alpha.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API" href="../api/API.html" />
    <link rel="prev" title="Welcome to gbm_drm_gen’s documentation!" href="../index.html" />
  <link rel="stylesheet" href="../_static/pygments/default.css" type="text/css" id="pygments-style">
  <link rel="stylesheet" href="../_static/custom.css" type="text/css">
   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> gbm_drm_gen
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generating DRMs for GBM detectors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Into-the-details">Into the details</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-energy-binning">custom energy binning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Log-spaced-energies">Log-spaced energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-custom-array">a custom array</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-RSP2-files">Creating RSP2 files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html#gbm-drm-gen">gbm_drm_gen</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gbm_drm_gen</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <!--
  <div class="admonition note">
    <p><a href="https://github.com/lukelbd">ProPlot author here</a>: Due to my day job as a graduate student, certain <a href="https://github.com/lukelbd/proplot/pulls?q=is%3Aopen+is%3Apr">feature additions</a> may be delayed to the summer of 2020. In the meantime, if you are interested in contributing to ProPlot, please see the <a href="https://proplot.readthedocs.io/en/latest/contributions.html">contribution guide</a>. Any amount of help is welcome!
    </p>
  </div>
  -->
  <li id="lightdark-li">
    <label for="lightdark-checkbox" id="lightdark-label">
      <input type="checkbox" id="lightdark-checkbox"/>
      <div class="btn-neutral"></div>
    </label>
  </li>
  
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Generating DRMs for GBM detectors</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script type="text/javascript" src=../_static/custom.js></script>
  
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Generating-DRMs-for-GBM-detectors">
<h1>Generating DRMs for GBM detectors<a class="headerlink" href="#Generating-DRMs-for-GBM-detectors" title="Permalink to this headline">¶</a></h1>
<p>The main purpose for <code class="docutils literal notranslate"><span class="pre">gbm_drm_gen</span></code> is a fast and easy way to generate detector response matrices for the Fermi-GBM detectors in a pythonic way.</p>
<p>When we want to generate DRMS for GBM detectors, we simply need to obtain the proper data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">astropy.io.fits</span> <span class="k">as</span> <span class="nn">fits</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">jupyterthemes</span> <span class="kn">import</span> <span class="n">jtplot</span>

<span class="n">jtplot</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;talk&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">gbm_drm_gen</span> <span class="kn">import</span> <span class="n">DRMGen</span>
<span class="kn">from</span> <span class="nn">gbm_drm_gen.utils.package_data</span> <span class="kn">import</span> <span class="n">get_path_of_data_file</span>




</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: AstropyDeprecationWarning: The private astropy._erfa module has been made into its own package, pyerfa, which is a dependency of astropy and can be imported directly using &#34;import erfa&#34; [astropy._erfa]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The naima package is not available. Models that depend on it will not be available</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The GSL library or the pygsl wrapper cannot be loaded. Models that depend on it will not be available.</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The ebltable package is not available. Models that depend on it will not be available</span>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Starting 3ML!</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> no display variable set. using backend for graphics without display (agg)</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> ROOT minimizer not available</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> Multinest minimizer not available</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> PyGMO is not available</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The cthreeML package is not installed. You will not be able to use plugins which require the C/C++ interface (currently HAWC)</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> Could not import plugin FermiLATLike.py. Do you have the relative instrument software installed and configured?</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> Could not import plugin HAWCLike.py. Do you have the relative instrument software installed and configured?</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> Env. variable OMP_NUM_THREADS is not set. Please set it to 1 for optimal performances in 3ML</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> Env. variable MKL_NUM_THREADS is not set. Please set it to 1 for optimal performances in 3ML</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> Env. variable NUMEXPR_NUM_THREADS is not set. Please set it to 1 for optimal performances in 3ML</span>
</pre></div></div>
</div>
<div class="section" id="quick-start">
<h2>quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>To create a DRM generator for TTE data, we need the TTE, CSPEC, and the TRIGDAT data files. * The CSPEC data contains the output side of the DRM’s energy bounds. * The TRIGDAT data contains the spacecraft orientation data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">trigdat_file</span> <span class="o">=</span> <span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s1">&#39;example_data/glg_trigdat_all_bn110721200_v01.fit&#39;</span><span class="p">)</span>
<span class="n">cspec_file</span> <span class="o">=</span> <span class="n">get_path_of_data_file</span><span class="p">(</span><span class="s1">&#39;example_data/glg_cspec_n6_bn110721200_v00.pha&#39;</span><span class="p">)</span>


<span class="c1"># create the generator</span>
<span class="n">gbm_n6_generator</span> <span class="o">=</span> <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># time relative to T0 or trigger time.</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can set the location of the source directly. The first run can be a bit slow as <code class="docutils literal notranslate"><span class="pre">numba</span></code> is used in the background to be very fast.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">set_location</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can now checkout the matrix object created in the background:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">matrix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1.21529588e-02, 2.66685346e-02, 3.35702294e-02, ...,
        1.71696052e-02, 1.79967322e-02, 0.00000000e+00],
       [2.40656348e-03, 9.02243768e-03, 2.44969585e-02, ...,
        1.76004235e-02, 1.84410737e-02, 0.00000000e+00],
       [0.00000000e+00, 6.64336828e-04, 4.79652366e-03, ...,
        1.75084305e-02, 1.83343065e-02, 0.00000000e+00],
       ...,
       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
        1.18137462e-01, 1.18589681e-01, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
        1.19105016e-01, 1.19567934e-01, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
        2.49905465e+00, 2.50882594e+00, 0.00000000e+00]])
</pre></div></div>
</div>
<p>Or we can input RA and DEC to create a 3ML style OGIP response directly:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">response</span> <span class="o">=</span> <span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">to_3ML_response</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

WARNING MatplotlibDeprecationWarning: You are modifying the state of a globally registered colormap. This has been deprecated since 3.3 and in 3.6, you will not be able to modify a registered colormap in-place. To remove this warning, you can make a copy of the colormap first. cmap = mpl.cm.get_cmap(&#34;ocean&#34;).copy()

</pre></div></div>
</div>
<p>To see how the effective area varies with location, we can loop through various angles.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">monte_carlo_energies</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">monte_carlo_energies</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span><span class="o">.</span><span class="n">T</span>
<span class="n">de</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">ene</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ra</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">260</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>

    <span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">set_location</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ene</span><span class="p">,</span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">$^{\circ}$&#39;</span><span class="o">%</span><span class="k">ra</span>)

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Effective Area (cm$^2$)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MC Energies&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Into-the-details">
<h2>Into the details<a class="headerlink" href="#Into-the-details" title="Permalink to this headline">¶</a></h2>
<p>Ok, now let’s go through the various specifics of the DRM generator constructor.</p>
<p>First, the generator needs to know:</p>
<ul class="simple">
<li><p>The current location and oreintation of GBM for the data of interest.</p></li>
<li><p>The channel to PHA reconstructed energy from the CSPEC files.</p></li>
</ul>
<p>For the first, one can get the current spacecraft from the either the triggers trigdat file, or for non-trggered data, one can obtain the position history file. These are available at the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/FTP/fermi/data/gbm/">NASA database</a>. If using a position history file. You need to specify <code class="docutils literal notranslate"><span class="pre">T0=&lt;Fermi</span> <span class="pre">MET&gt;</span></code> in the constructor so that the time coordinate will be relative to this MET.</p>
<p>Internally, the class uses <a class="reference external" href="https://gbmgeometry.readthedocs.io/en/latest/">gbmgeometry</a> to convert RA,Dec to the approriate spacecraft coordinates. However, one can also create DRMs in spacecraft coordinates directly.</p>
</div>
<div class="section" id="custom-energy-binning">
<h2>custom energy binning<a class="headerlink" href="#custom-energy-binning" title="Permalink to this headline">¶</a></h2>
<p>Maybe you are a curious person and want to investigate a response with finer input energies to model line features in solar flares?</p>
<p>It is possible to add a custom array of input energies. To do this we need to import the <code class="docutils literal notranslate"><span class="pre">NaITTEEdges</span></code> and <code class="docutils literal notranslate"><span class="pre">BgoTTEEdges</span></code> classes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm_drm_gen</span> <span class="kn">import</span>  <span class="n">NaiTTEEdges</span><span class="p">,</span> <span class="n">BgoTTEEdges</span>
</pre></div>
</div>
</div>
<p>These objects allow you to specify input (monte carlo) energies either from an array or in log spaced binning.</p>
<div class="admonition note">
<p><strong>Note:</strong> The number of energies must be off and include the low and high end points which are specific to the NaI [5.0, 50000.0] and BGO [100., 200000.0] detectors.</p>
</div>
<div class="section" id="Log-spaced-energies">
<h3>Log-spaced energies<a class="headerlink" href="#Log-spaced-energies" title="Permalink to this headline">¶</a></h3>
<p>First we will try with <strong>VERY</strong> fine log spaced binning above the typical 140 input energies</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">custom_edges</span> <span class="o">=</span> <span class="n">NaiTTEEdges</span><span class="o">.</span><span class="n">from_log_bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">531</span><span class="p">)</span>


<span class="n">gbm_n6_generator</span> <span class="o">=</span> <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">,</span>
                             <span class="c1"># pass the custom edges</span>
                             <span class="n">custom_input_edges</span><span class="o">=</span><span class="n">custom_edges</span>

                            <span class="p">)</span>


<span class="n">response</span> <span class="o">=</span> <span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">to_3ML_response</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

WARNING MatplotlibDeprecationWarning: You are modifying the state of a globally registered colormap. This has been deprecated since 3.3 and in 3.6, you will not be able to modify a registered colormap in-place. To remove this warning, you can make a copy of the colormap first. cmap = mpl.cm.get_cmap(&#34;ocean&#34;).copy()

</pre></div></div>
</div>
<p>And now with a much coarser input binning:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">custom_edges</span> <span class="o">=</span> <span class="n">NaiTTEEdges</span><span class="o">.</span><span class="n">from_log_bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">73</span><span class="p">)</span>


<span class="n">gbm_n6_generator</span> <span class="o">=</span>  <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">,</span>
                             <span class="c1"># pass the custom edges</span>
                             <span class="n">custom_input_edges</span><span class="o">=</span><span class="n">custom_edges</span>

                            <span class="p">)</span>


<span class="n">response</span> <span class="o">=</span> <span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">to_3ML_response</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>It is easier to see the difference with simple matrix plotting:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">custom_edges</span> <span class="o">=</span> <span class="n">NaiTTEEdges</span><span class="o">.</span><span class="n">from_log_bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">91</span><span class="p">)</span>


<span class="n">gbm_n6_generator</span> <span class="o">=</span>  <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">,</span>
                             <span class="c1"># pass the custom edges</span>
                             <span class="n">custom_input_edges</span><span class="o">=</span><span class="n">custom_edges</span>

                            <span class="p">)</span>

<span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">set_location</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">custom_edges</span> <span class="o">=</span> <span class="n">NaiTTEEdges</span><span class="o">.</span><span class="n">from_log_bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">141</span><span class="p">)</span>


<span class="n">gbm_n6_generator</span> <span class="o">=</span>  <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">,</span>
                             <span class="c1"># pass the custom edges</span>
                             <span class="n">custom_input_edges</span><span class="o">=</span><span class="n">custom_edges</span>

                            <span class="p">)</span>

<span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">set_location</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>



<span class="n">custom_edges</span> <span class="o">=</span> <span class="n">NaiTTEEdges</span><span class="o">.</span><span class="n">from_log_bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">1541</span><span class="p">)</span>


<span class="n">gbm_n6_generator</span> <span class="o">=</span>  <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">,</span>
                             <span class="c1"># pass the custom edges</span>
                             <span class="n">custom_input_edges</span><span class="o">=</span><span class="n">custom_edges</span>

                            <span class="p">)</span>

<span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">set_location</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x7f1d1443b820&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

WARNING RuntimeWarning: overflow encountered in double_scalars


WARNING RuntimeWarning: overflow encountered in double_scalars

</pre></div></div>
</div>
</div>
<div class="section" id="a-custom-array">
<h3>a custom array<a class="headerlink" href="#a-custom-array" title="Permalink to this headline">¶</a></h3>
<p>And we can even supply and entirely custom array of energies:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">50000.</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>


<span class="n">custom_edges</span> <span class="o">=</span> <span class="n">NaiTTEEdges</span><span class="o">.</span><span class="n">from_custom_array</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>


<span class="n">gbm_n6_generator</span> <span class="o">=</span>  <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">,</span>
                             <span class="c1"># pass the custom edges</span>
                             <span class="n">custom_input_edges</span><span class="o">=</span><span class="n">custom_edges</span>

                            <span class="p">)</span>


<span class="n">response</span> <span class="o">=</span> <span class="n">gbm_n6_generator</span><span class="o">.</span><span class="n">to_3ML_response</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mi">329</span><span class="p">,</span><span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">38.2</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">plot_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Creating-RSP2-files">
<h2>Creating RSP2 files<a class="headerlink" href="#Creating-RSP2-files" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gbm_drm_gen</span> <span class="kn">import</span> <span class="n">create_rsp2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># create the generator</span>
<span class="n">gbm_n6_generator</span> <span class="o">=</span> <span class="n">DRMGen</span><span class="o">.</span><span class="n">from_128_bin_data</span><span class="p">(</span><span class="n">det_name</span><span class="o">=</span> <span class="s2">&quot;n6&quot;</span><span class="p">,</span>
                             <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># time relative to T0 or trigger time.</span>
                             <span class="n">trigdat</span> <span class="o">=</span> <span class="n">trigdat_file</span><span class="p">,</span>
                             <span class="n">mat_type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># direct response + atmospheric scattering</span>
                             <span class="n">cspecfile</span> <span class="o">=</span> <span class="n">cspec_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output_file_name</span> <span class="o">=</span> <span class="s2">&quot;my_new_rsp.rsp2&quot;</span> <span class="c1"># you must call it an RSP2 file!</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">create_rsp2</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">,</span>
            <span class="n">response_generator</span><span class="o">=</span><span class="n">gbm_n6_generator</span><span class="p">,</span>
            <span class="n">ra</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">dec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">tstart</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">tstop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">delta_time</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
           <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

    <span class="n">f</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;DRM_NUM&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;TSTART&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;TSTOP&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filename: my_new_rsp.rsp2
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU       5   ()
  1  EBOUNDS       1 BinTableHDU     28   128R x 3C   [K, E, E]
  2  SPECRESP MATRIX    1 BinTableHDU     42   140R x 6C   [E, E, I, I, I, 128D]
  3  SPECRESP MATRIX    2 BinTableHDU     42   140R x 6C   [E, E, I, I, I, 128D]
  4  SPECRESP MATRIX    3 BinTableHDU     42   140R x 6C   [E, E, I, I, I, 128D]
  5  SPECRESP MATRIX    4 BinTableHDU     42   140R x 6C   [E, E, I, I, I, 128D]
  6  SPECRESP MATRIX    5 BinTableHDU     42   140R x 6C   [E, E, I, I, I, 128D]
5
332916465.760476
332916467.760476
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">threeML</span> <span class="kn">import</span> <span class="n">TimeSeriesBuilder</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tsb</span> <span class="o">=</span> <span class="n">TimeSeriesBuilder</span><span class="o">.</span><span class="n">from_gbm_cspec_or_ctime</span><span class="p">(</span><span class="s2">&quot;cspec&quot;</span><span class="p">,</span> <span class="n">cspec_or_ctime_file</span><span class="o">=</span><span class="n">cspec_file</span><span class="p">,</span> <span class="n">rsp_file</span><span class="o">=</span><span class="s2">&quot;my_new_rsp.rsp2&quot;</span><span class="p">)</span>

<span class="n">tsb</span><span class="o">.</span><span class="n">view_lightcurve</span><span class="p">();</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The default choice for MATRIX extension failed:KeyError(&#34;Extension (&#39;MATRIX&#39;, 1) not found.&#34;)available: None &#39;EBOUNDS&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39;</span>
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

WARNING FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison


WARNING FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2d6c8cc942b544bab4ed70d7b11a1f05", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The default choice for MATRIX extension failed:KeyError(&#34;Extension (&#39;MATRIX&#39;, 1) not found.&#34;)available: None &#39;EBOUNDS&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39;</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The default choice for MATRIX extension failed:KeyError(&#34;Extension (&#39;MATRIX&#39;, 2) not found.&#34;)available: None &#39;EBOUNDS&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39;</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The default choice for MATRIX extension failed:KeyError(&#34;Extension (&#39;MATRIX&#39;, 3) not found.&#34;)available: None &#39;EBOUNDS&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39;</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The default choice for MATRIX extension failed:KeyError(&#34;Extension (&#39;MATRIX&#39;, 4) not found.&#34;)available: None &#39;EBOUNDS&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39;</span>
[<span class="ansi-magenta-fg">WARNING </span>]<span class="ansi-magenta-fg"> The default choice for MATRIX extension failed:KeyError(&#34;Extension (&#39;MATRIX&#39;, 5) not found.&#34;)available: None &#39;EBOUNDS&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39; &#39;SPECRESP MATRIX&#39;</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tsb</span><span class="o">.</span><span class="n">set_active_time_interval</span><span class="p">(</span><span class="s1">&#39;1-5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[<span class="ansi-green-fg">INFO    </span>]<span class="ansi-green-fg"> Interval set to 0.7039839625358582-4.800044000148773 for cspec</span>
</pre></div></div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"0cb90047d8c44715b282a3489b09200e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "2d6c8cc942b544bab4ed70d7b11a1f05": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_84001f5d8a024ab5b73c016837ba3d1c", "IPY_MODEL_dbb370a70756408487656716b53e07b5", "IPY_MODEL_dcb4da9dc4c2464e94d5b3f9345d5bee"], "layout": "IPY_MODEL_f59c0e3cdb974ceaa1eb9cf5f4126903"}}, "30ac072b15b7400daf3c71fa2e555655": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "65866fac174040bfb63082aaffb89a8c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": "#440154", "description_width": ""}}, "84001f5d8a024ab5b73c016837ba3d1c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_99ce846598d348f48ffec3f0ca3d1162", "placeholder": "\u200b", "style": "IPY_MODEL_b1ae2afeb7724070876b6cdaabee420d", "value": "Loading PHAII Spectra: 100%"}}, "99ce846598d348f48ffec3f0ca3d1162": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b1ae2afeb7724070876b6cdaabee420d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "bb74e65f54ae443eabd69d3dd2997de5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dbb370a70756408487656716b53e07b5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_30ac072b15b7400daf3c71fa2e555655", "max": 2395.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_65866fac174040bfb63082aaffb89a8c", "value": 2395.0}}, "dcb4da9dc4c2464e94d5b3f9345d5bee": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_bb74e65f54ae443eabd69d3dd2997de5", "placeholder": "\u200b", "style": "IPY_MODEL_0cb90047d8c44715b282a3489b09200e", "value": " 2395/2395 [00:01&lt;00:00, 1153.44it/s]"}}, "f59c0e3cdb974ceaa1eb9cf5f4126903": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}}, "version_major": 2, "version_minor": 0}
</script></div>
</div>


           </div>
           
          </div>

          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../api/API.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to gbm_drm_gen’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2021, J. Michael Burgess, Bjoern Biltzinger and Felix Kunzweiler.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>